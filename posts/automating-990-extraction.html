<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="NoProfits.org - Blogs about science, nonprofits, and other fun stuff.">
    <title>NoProfits Blog</title>
    <link rel="stylesheet" href="../css/default.css" />
    <script defer src="../js/mathjax-config.js"></script>
    <script defer src="../js/code-copy.js"></script>
    <script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="icon" type="image/svg+xml" href="../images/favicon.svg">
</head>

<body>
    <header>
        <div class="logo">
            <a href="../">NoProfits Blog</a>
        </div>
        <nav>
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../archive.html">Archive</a>
            <a href="../contact.html">Contact</a>
        </nav>
    </header>

    <main role="main">
        <div class="info">
    <h3>DRAFT - Automating IRS Form 990 Data Extraction - A Programmatic Approach to Nonprofit Data Analysis</h3>
    Posted on April  3, 2025
    
</div>

<h2 id="introduction">Introduction</h2>
<p>The Internal Revenue Service (IRS) Form 990 provides a wealth of information about tax-exempt organizations in the United States. However, accessing and analyzing this data has historically been challenging due to the complexities of the IRS data repository structure.<span class="citation" data-cites="williams2023 ottinger2022"><sup>1,2</sup></span> Building upon previous work towards mapping the structure of the IRS Form 990 data repository, the current aim is to further advance programmatic methods to efficiently probe and analyze specific organizations within the Form 990 dataset.[Anthropic2025Claude]</p>
<p>The availability of Form 990 data in electronic format has increased significantly since the introduction of e-filing requirements for tax-exempt organizations.<span class="citation" data-cites="blackwood2013"><sup><strong>blackwood2013?</strong></sup></span> Despite this progress, challenges persist in terms of data accessibility, quality, and usability for research purposes.<span class="citation" data-cites="noveck2013"><sup><strong>noveck2013?</strong></sup></span> Existing approaches to Form 990 data analysis often rely on manual extraction methods or limited subsets of the available data, hindering the ability to conduct comprehensive, longitudinal studies of the nonprofit sector.<span class="citation" data-cites="borenstein2018"><sup><strong>borenstein2018?</strong></sup></span></p>
<p>To address these limitations, we propose a programmatic approach to automate the extraction and analysis of Form 990 data for targeted organizations. By leveraging advanced computational techniques and focusing on specific Employer Identification Numbers (EINs) of interest, this study aims to demonstrate the feasibility and benefits of a more efficient, scalable, and reproducible method for nonprofit data discovery.</p>
<h2 id="experimental">Experimental</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> boto3</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xml.etree.ElementTree <span class="im">as</span> ET</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>S3_BUCKET <span class="op">=</span> <span class="st">&quot;irs-form-990&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>TARGET_EINS <span class="op">=</span> [</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;13-6213516&quot;</span>,  <span class="co"># American Civil Liberties Union Foundation</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;53-0196605&quot;</span>,  <span class="co"># American National Red Cross</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;13-1635294&quot;</span>,  <span class="co"># United Way Worldwide</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;13-1644147&quot;</span>,  <span class="co"># Planned Parenthood Federation of America</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;53-0242652&quot;</span>,  <span class="co"># Nature Conservancy</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_form990_filings(ein: <span class="bu">str</span>, start_year: <span class="bu">int</span>, end_year: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    s3 <span class="op">=</span> boto3.resource(<span class="st">&quot;s3&quot;</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    bucket <span class="op">=</span> s3.Bucket(S3_BUCKET)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    filings <span class="op">=</span> []</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>ein<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        objects <span class="op">=</span> bucket.objects.<span class="bu">filter</span>(Prefix<span class="op">=</span>prefix)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> obj <span class="kw">in</span> objects:</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> obj.key.endswith(<span class="st">&quot;.xml&quot;</span>):</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>                filings.append(obj.key)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> filings</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_form990_xml(xml_content: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>:</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> ET.fromstring(xml_content)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> {</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ein&quot;</span>: root.find(<span class="st">&quot;EIN&quot;</span>).text,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;organization_name&quot;</span>: root.find(<span class="st">&quot;BusinessName/BusinessNameLine1&quot;</span>).text,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;tax_year&quot;</span>: root.find(<span class="st">&quot;TaxYear&quot;</span>).text,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;total_revenue&quot;</span>: root.find(<span class="st">&quot;TotalRevenueAmt&quot;</span>).text,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;total_expenses&quot;</span>: root.find(<span class="st">&quot;TotalExpensesAmt&quot;</span>).text,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;net_assets&quot;</span>: root.find(<span class="st">&quot;NetAssetsOrFundBalancesEOYAmt&quot;</span>).text,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ein <span class="kw">in</span> TARGET_EINS:</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="ss">f&quot;Retrieving Form 990 filings for EIN: </span><span class="sc">{</span>ein<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        filings <span class="op">=</span> get_form990_filings(ein, <span class="dv">2019</span>, <span class="dv">2025</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> filing <span class="kw">in</span> filings:</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Parsing Form 990 XML: </span><span class="sc">{</span>filing<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>            obj <span class="op">=</span> s3.Object(S3_BUCKET, filing)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>            xml_content <span class="op">=</span> obj.get()[<span class="st">&quot;Body&quot;</span>].read().decode(<span class="st">&quot;utf-8&quot;</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> parse_form990_xml(xml_content)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Extracted data: </span><span class="sc">{</span>data<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<p>The experimental process involves the following steps:</p>
<ol type="1">
<li><p>Import necessary Python libraries: <code>boto3</code> for interacting with AWS S3, <code>logging</code> for logging, <code>xml.etree.ElementTree</code> for parsing XML, and <code>typing</code> for type hinting.</p></li>
<li><p>Configure logging to output log messages to the console with the <code>INFO</code> level.</p></li>
<li><p>Define constants for the S3 bucket name (<code>S3_BUCKET</code>) and the list of target EINs (<code>TARGET_EINS</code>).</p></li>
<li><p>Implement the <code>get_form990_filings</code> function to retrieve Form 990 XML filings for a given EIN within a specified year range from the S3 bucket. The function returns a list of S3 object keys representing the XML filings.</p></li>
<li><p>Implement the <code>parse_form990_xml</code> function to parse the XML content of a Form 990 filing and extract relevant data fields such as EIN, organization name, tax year, total revenue, total expenses, and net assets. The function returns a dictionary containing the extracted data.</p></li>
<li><p>In the <code>main</code> function, iterate over the target EINs and perform the following steps for each EIN:</p>
<ul>
<li>Retrieve Form 990 filings for the EIN within the specified year range using the <code>get_form990_filings</code> function.</li>
<li>For each retrieved filing, read the XML content from the S3 object.</li>
<li>Parse the XML content using the <code>parse_form990_xml</code> function to extract relevant data.</li>
<li>Log the extracted data for each filing.</li>
</ul></li>
<li><p>Run the <code>main</code> function when the script is executed.</p></li>
</ol>
<p>Note: The provided code assumes the necessary AWS credentials are configured in the environment where the script is run, allowing access to the S3 bucket.</p>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-williams2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Williams, J.; Akaakar, A. <a href="https://johnsoncenter.org/blog/irs-delays-and-other-barriers-to-data-mean-real-risks-for-nonprofits/">IRS Delays and Other Barriers to Data Mean Real Risks for Nonprofits</a>. <em>Johnson Center for Philanthropy Blog</em> <strong>2023</strong>.</div>
</div>
<div id="ref-ottinger2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Ottinger, C. S.; Williams, J. <a href="https://ssir.org/articles/entry/unlocking_the_potential_of_open_990_data">Unlocking the Potential of Open 990 Data</a>. <em>Stanford Social Innovation Review</em> <strong>2022</strong>.</div>
</div>
</div>
    </main>

<footer>
    <div class="footer-content">
        <div class="footer-text">
            Site generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>, authored by <a href="https://noprofits.org">No Profits</a> 
        </br>Select content assisted by <a href="https://www.anthropic.com/claude">Claude</a> - <a href="../colophon.html">Colophon</a>
        </div>
        <div class="print-pdf-button">
            <button onclick="window.print();" class="print-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="print-icon">
                    <polyline points="6 9 6 2 18 2 18 9"></polyline>
                    <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                    <rect x="6" y="14" width="12" height="8"></rect>
                </svg>
                Print / Save as PDF
            </button>
        </div>
    </div>
</footer>
</body>

</html>